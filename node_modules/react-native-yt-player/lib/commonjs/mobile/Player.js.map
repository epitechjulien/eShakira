{"version":3,"sources":["Player.tsx"],"names":["Value","Animated","timing","IsAndroid","Platform","OS","Player","props","_width","VideoSize","inline","width","_isUserUsingIconToFullScreen","onDurationReady","duration","setState","onStart","onPlaying","currentTime","onReady","ready","onError","onEnd","loop","seekTo","playVideo","onStateChange","state","onPlaybackRateChange","onPlaybackQualityChange","play","player","_playVideo","s","_seekTo","pauseVideo","_pauseVideo","toggleFS","setTimeout","rotateToFullScreen","fullScreen","goToFullScreen","Orientation","lockToLandscapeRight","goToInlineScreen","lockToPortrait","unlockAllOrientations","onRotated","orientation","onBackButtonClick","onFullScreen","toValue","easing","Easing","inOut","ease","start","StatusBar","setHidden","onLayout","nativeEvent","layout","x","y","layoutReady","top","left","autoPlay","addOrientationListener","BackHandler","addEventListener","removeOrientationListener","removeEventListener","height","VideoStyle","styles","AbsoluteStyle","videoId","topBar","showFullScreenButton","style","wrapper","PureComponent","defaultProps","PlayerDefaultProps"],"mappings":"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","sourcesContent":["import React, { PureComponent } from \"react\";\nimport Animated, { Easing } from \"react-native-reanimated\";\nconst { Value, timing } = Animated;\n\nimport { View, StatusBar, Platform, BackHandler } from \"react-native\";\nimport styles from \"./styles\";\nimport PlayerControls from \"./Controls\";\nimport PlayerView from \"./YTWebView\";\nimport {\n  YTWebViewState,\n  PlayerState,\n  PlayerProps,\n  PlayerDefaultProps\n} from \"./types\";\nimport { fullScreenInterpolate, VideoSize } from \"./Utils\";\nimport Orientation from \"react-native-orientation\";\n\nconst IsAndroid = Platform.OS === \"android\";\n\nexport default class Player extends PureComponent<PlayerProps, PlayerState> {\n  static defaultProps = PlayerDefaultProps;\n\n  constructor(props: PlayerProps) {\n    super(props);\n    this.state = {\n      ready: false,\n      layoutReady: !IsAndroid,\n      fullScreen: false,\n      play: this.props.autoPlay,\n      duration: 0,\n      currentTime: 0,\n      layout: {\n        top: 0,\n        left: 0\n      }\n    };\n  }\n  player: any;\n\n  _width = new Value(VideoSize.inline.width);\n  _isUserUsingIconToFullScreen = false;\n\n  componentDidMount() {\n    Orientation.addOrientationListener(this.onRotated);\n\n    BackHandler.addEventListener(\"hardwareBackPress\", this.onBackButtonClick);\n  }\n\n  componentWillUnmount() {\n    Orientation.removeOrientationListener(this.onRotated);\n    BackHandler.removeEventListener(\n      \"hardwareBackPress\",\n      this.onBackButtonClick\n    );\n  }\n\n  // listeners\n  onDurationReady = (duration: number) => {\n    this.setState({ duration });\n    this.props.onDurationReady(duration);\n    this.props.onStart();\n  };\n\n  onPlaying = (currentTime: number) => {\n    this.setState({ currentTime });\n    this.props.onPlaying(currentTime);\n  };\n  onReady = () => {\n    this.setState({ ready: true });\n    this.props.onReady();\n  };\n  onError = () => {\n    this.props.onError();\n  };\n  onEnd = () => {\n    const { onEnd, loop } = this.props;\n    onEnd();\n    if (loop) {\n      this.seekTo(0);\n      this.playVideo();\n    }\n  };\n\n  onStateChange = (state: YTWebViewState) => {\n    this.props.onStateChange(state);\n  };\n  onPlaybackRateChange = () => {};\n  onPlaybackQualityChange = () => {};\n\n  playVideo = () => {\n    this.setState({ play: true });\n    this.player._playVideo();\n  };\n  seekTo = async (s: number) => {\n    this.setState({ currentTime: s });\n    this.player._seekTo(s);\n  };\n\n  pauseVideo = () => {\n    this.setState({ play: false });\n    this.player._pauseVideo();\n  };\n\n  toggleFS = () => {\n    this._isUserUsingIconToFullScreen = true;\n    setTimeout(() => {\n      this._isUserUsingIconToFullScreen = false;\n    }, 2000);\n    const rotateToFullScreen = true;\n    this.setState({ fullScreen: !this.state.fullScreen }, () => {\n      if (this.state.fullScreen) {\n        this.goToFullScreen();\n        if (rotateToFullScreen) Orientation.lockToLandscapeRight();\n      } else {\n        this.goToInlineScreen();\n        if (rotateToFullScreen) Orientation.lockToPortrait();\n        setTimeout(() => {\n          if (true) Orientation.unlockAllOrientations();\n        }, 2000);\n      }\n    });\n  };\n\n  onRotated = orientation => {\n    if (this._isUserUsingIconToFullScreen) return;\n    Orientation.unlockAllOrientations();\n    const rotateToFullScreen = true;\n    if (rotateToFullScreen) {\n      if (orientation === \"LANDSCAPE\" || orientation === \"PORTRAITUPSIDEDOWN\") {\n        if (this.state.fullScreen) return;\n        this.setState({ fullScreen: true }, () => {\n          this.goToFullScreen();\n          Orientation.unlockAllOrientations();\n        });\n        return;\n      } else {\n        if (!this.state.fullScreen) return;\n\n        this.setState(\n          {\n            fullScreen: false\n          },\n          () => {\n            this.goToInlineScreen();\n          }\n        );\n        return;\n      }\n    } else {\n      this.goToInlineScreen();\n    }\n  };\n  onBackButtonClick = () => {\n    if (this.state.fullScreen) {\n      this.toggleFS();\n      return true;\n    }\n\n    return false;\n  };\n\n  goToFullScreen = () => {\n    this.props.onFullScreen(true);\n    timing(this._width, {\n      toValue: VideoSize.fullScreen.width + 2,\n      duration: 200,\n      easing: Easing.inOut(Easing.ease)\n    }).start(() => StatusBar.setHidden(true));\n  };\n  goToInlineScreen = () => {\n    this.props.onFullScreen(false);\n    timing(this._width, {\n      toValue: VideoSize.inline.width,\n      duration: 200,\n      easing: Easing.inOut(Easing.ease)\n    }).start(() => StatusBar.setHidden(false));\n  };\n  onLayout = ({\n    nativeEvent: {\n      layout: { x, y }\n    }\n  }: any) => {\n    this.setState({ layoutReady: true, layout: { top: y, left: x } });\n  };\n\n  render() {\n    const { fullScreen } = this.state;\n    const { height, top, left } = fullScreenInterpolate(\n      this._width,\n      this.state.layout\n    );\n\n    const VideoStyle = fullScreen\n      ? { ...styles.fullScreen }\n      : {\n          ...styles.inline\n        };\n\n    const AbsoluteStyle = IsAndroid ? { ...this.state.layout } : {};\n\n    const { playVideo, pauseVideo, seekTo, toggleFS } = this;\n    const { videoId, autoPlay, topBar, showFullScreenButton } = this.props;\n    const style: any = {\n      ...VideoStyle,\n      ...AbsoluteStyle,\n      width: this._width,\n      height,\n      top,\n      left\n      // transform: [\n      //   { translateY },\n      //   { translateX },\n      //   { rotateZ: concat(rotate as any, \"deg\" as any) }\n      // ],\n    };\n    if (IsAndroid)\n      return (\n        <React.Fragment>\n          <View style={styles.wrapper} onLayout={this.onLayout} />\n          {this.state.layoutReady && (\n            <Animated.View style={style} removeClippedSubviews={true}>\n              <PlayerView\n                videoId={videoId}\n                autoPlay={autoPlay}\n                ref={(player: any) => (this.player = player)}\n                onDurationReady={this.onDurationReady}\n                onReady={this.onReady}\n                onError={this.onError}\n                onPlaying={this.onPlaying}\n                onEnd={this.onEnd}\n              />\n              <PlayerControls\n                {...{\n                  playVideo,\n                  seekTo,\n                  pauseVideo,\n                  toggleFS,\n                  topBar,\n                  showFullScreenButton,\n                  ...this.state\n                }}\n              />\n            </Animated.View>\n          )}\n        </React.Fragment>\n      );\n    else\n      return (\n        <View style={styles.wrapper} onLayout={this.onLayout}>\n          <Animated.View style={style}>\n            <PlayerView\n              videoId={videoId}\n              autoPlay={autoPlay}\n              ref={(player: any) => (this.player = player)}\n              onDurationReady={this.onDurationReady}\n              onReady={this.onReady}\n              onError={this.onError}\n              onPlaying={this.onPlaying}\n              onEnd={this.onEnd}\n            />\n            <PlayerControls\n              {...{\n                playVideo,\n                seekTo,\n                pauseVideo,\n                toggleFS,\n                topBar,\n                showFullScreenButton,\n                ...this.state\n              }}\n            />\n          </Animated.View>\n        </View>\n      );\n  }\n}\n"]}